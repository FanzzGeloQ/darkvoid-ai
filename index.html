<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DARKVOID AI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }

        :root {
            --primary-gradient: linear-gradient(135deg, #8B5CF6 0%, #7C3AED 100%);
            --primary-light: #A855F7;
            --dark-bg: #0F0F23;
            --darker-bg: #0A0A18;
            --card-bg: rgba(30, 30, 46, 0.95);
            --sidebar-bg: rgba(20, 20, 35, 0.98);
            --text-primary: #FFFFFF;
            --text-secondary: #B0B0CC;
            --text-muted: #8888AA;
            --border-color: rgba(139, 92, 246, 0.3);
            --hover-bg: rgba(139, 92, 246, 0.15);
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --shadow-lg: 0 20px 60px rgba(0, 0, 0, 0.5);
            --shadow-md: 0 10px 30px rgba(0, 0, 0, 0.3);
            --border-radius: 16px;
            --border-radius-sm: 12px;
            --glass-bg: rgba(255, 255, 255, 0.05);
        }

        body {
            background: var(--dark-bg);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
        }

        /* TOAST NOTIFICATION */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 400px;
        }

        .toast {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            padding: 16px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideInRight 0.3s ease-out;
            box-shadow: var(--shadow-md);
            backdrop-filter: blur(10px);
        }

        .toast.success {
            border-left: 4px solid var(--success);
        }

        .toast.error {
            border-left: 4px solid var(--danger);
        }

        .toast.info {
            border-left: 4px solid var(--primary-light);
        }

        .toast.warning {
            border-left: 4px solid var(--warning);
        }

        .toast-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        .toast.success .toast-icon { color: var(--success); }
        .toast.error .toast-icon { color: var(--danger); }
        .toast.info .toast-icon { color: var(--primary-light); }
        .toast.warning .toast-icon { color: var(--warning); }

        .toast-content {
            flex: 1;
            font-size: 14px;
            line-height: 1.5;
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 18px;
            padding: 4px;
            margin-left: 8px;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        /* LOGIN SCREEN */
        #loginScreen {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            background: linear-gradient(135deg, #0A0A18 0%, #1A1A2E 100%);
        }

        .login-container {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 48px;
            width: 100%;
            max-width: 440px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-lg);
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .logo-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo-gradient {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 42px;
            font-weight: 800;
            letter-spacing: -1px;
            margin-bottom: 8px;
        }

        .logo-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        .login-message {
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: 32px;
            font-size: 16px;
            line-height: 1.6;
        }

        /* LOGIN TABS */
        .login-tabs {
            display: flex;
            margin-bottom: 32px;
            border-bottom: 1px solid var(--border-color);
        }

        .login-tab {
            flex: 1;
            padding: 16px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .login-tab:hover {
            color: var(--text-primary);
        }

        .login-tab.active {
            color: var(--primary-light);
        }

        .login-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-gradient);
            border-radius: 3px 3px 0 0;
        }

        .login-form-container {
            position: relative;
            min-height: 280px;
        }

        .login-form {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            opacity: 0;
            transform: translateX(-20px);
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .login-form.active {
            opacity: 1;
            transform: translateX(0);
            pointer-events: all;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-primary);
            font-size: 15px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
            background: rgba(255, 255, 255, 0.08);
        }

        .btn {
            width: 100%;
            padding: 16px;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .error-message {
            color: var(--danger);
            font-size: 14px;
            margin-top: 8px;
            display: none;
        }

        .success-message {
            color: var(--success);
            font-size: 14px;
            margin-top: 8px;
            display: none;
        }

        .hidden {
            display: none !important;
        }

        /* MAIN APP */
        #appScreen {
            display: none;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* Chat Header */
        .chat-header {
            padding: 16px 32px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(15, 15, 35, 0.95);
            backdrop-filter: blur(10px);
            z-index: 100;
            position: relative;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .mobile-menu-btn {
            display: none;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
        }

        .mobile-menu-btn:hover {
            background: var(--hover-bg);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: var(--primary-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
        }

        .user-details {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .username {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .user-tier {
            font-size: 11px;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 12px;
            display: inline-block;
        }

        .tier-member {
            color: var(--text-secondary);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--text-secondary);
        }

        .tier-vip {
            color: #8B5CF6;
            background: rgba(139, 92, 246, 0.2);
            border: 1px solid #8B5CF6;
        }

        .tier-premium {
            color: #3B82F6;
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid #3B82F6;
        }

        .tier-vvip {
            color: #F59E0B;
            background: rgba(245, 158, 11, 0.2);
            border: 1px solid #F59E0B;
        }

        .tier-kvip {
            color: #EC4899;
            background: rgba(236, 72, 153, 0.2);
            border: 1px solid #EC4899;
        }

        .header-actions {
            display: flex;
            gap: 12px;
        }

        .icon-btn {
            padding: 10px 16px;
            background: var(--glass-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-secondary);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .icon-btn:hover {
            background: var(--hover-bg);
            color: var(--text-primary);
            transform: translateY(-1px);
        }

        /* Chat Container */
        .chat-container {
            flex: 1;
            display: flex;
            overflow: hidden;
            position: relative;
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            background: var(--sidebar-bg);
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-color);
            transition: transform 0.3s ease;
            z-index: 99;
            position: relative;
        }

        .sidebar-header {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .new-chat-btn {
            width: 100%;
            padding: 12px;
            background: var(--primary-gradient);
            border: none;
            border-radius: var(--border-radius-sm);
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .new-chat-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .chat-history-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        .section-title {
            padding: 12px 16px;
            color: var(--text-secondary);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 1px solid var(--border-color);
            font-weight: 600;
        }

        .chat-list-container {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
        }

        .chat-list {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .chat-item {
            padding: 12px;
            border-radius: var(--border-radius-sm);
            font-size: 14px;
            cursor: pointer;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: all 0.3s ease;
        }

        .chat-item:hover {
            background: var(--hover-bg);
            color: var(--text-primary);
        }

        .chat-item.active {
            background: var(--primary-gradient);
            color: white;
        }

        .empty-chat-history {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
            font-size: 14px;
        }

        .empty-chat-history i {
            font-size: 32px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .sidebar-footer {
            padding: 16px;
            border-top: 1px solid var(--border-color);
            background: rgba(15, 15, 25, 0.8);
        }

        .sidebar-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .sidebar-btn {
            padding: 12px;
            background: var(--glass-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-secondary);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .sidebar-btn:hover {
            background: var(--hover-bg);
            color: var(--text-primary);
        }

        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 98;
            backdrop-filter: blur(2px);
        }

        /* Main Chat Area */
        .chat-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--dark-bg);
            min-width: 0;
        }

        .chat-title-container {
            padding: 20px 32px;
            border-bottom: 1px solid var(--border-color);
            background: rgba(15, 15, 35, 0.8);
            backdrop-filter: blur(10px);
        }

        .chat-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .chat-status {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .status-member {
            background: var(--glass-bg);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
        }

        .status-vip {
            background: rgba(139, 92, 246, 0.2);
            border: 1px solid var(--primary-light);
            color: var(--primary-light);
        }

        .status-premium {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid #3B82F6;
            color: #3B82F6;
        }

        .status-vvip {
            background: rgba(245, 158, 11, 0.2);
            border: 1px solid #F59E0B;
            color: #F59E0B;
        }

        .status-kvip {
            background: rgba(236, 72, 153, 0.2);
            border: 1px solid #EC4899;
            color: #EC4899;
        }

        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 32px;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.5) 0%, rgba(10, 10, 24, 0.5) 100%);
        }

        .welcome-message-ai {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
            padding: 48px 32px;
        }

        .welcome-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            padding: 40px;
            box-shadow: var(--shadow-md);
        }

        .welcome-card h2 {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 28px;
            margin-bottom: 16px;
        }

        /* Messages */
        .message {
            display: flex;
            gap: 16px;
            margin-bottom: 32px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            animation: slideIn 0.3s ease-out;
        }

        .message.ai {
            /* AI di kiri */
        }

        .message.user {
            /* User di kanan */
            flex-direction: row-reverse;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 16px;
        }

        .avatar.ai {
            background: var(--primary-gradient);
        }

        .avatar.user {
            background: linear-gradient(135deg, #3B82F6, #8B5CF6);
        }

        .message-content {
            flex: 1;
            padding: 20px;
            border-radius: var(--border-radius);
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            max-width: calc(100% - 52px);
            position: relative;
        }

        .message.ai .message-content {
            border-left: 3px solid var(--primary-light);
        }

        .message.user .message-content {
            border-right: 3px solid #3B82F6;
            background: rgba(59, 130, 246, 0.1);
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }

        .message.user .message-header {
            flex-direction: row-reverse;
        }

        .message-sender {
            font-weight: 600;
            font-size: 14px;
        }

        .message.ai .message-sender {
            color: var(--primary-light);
        }

        .message.user .message-sender {
            color: #3B82F6;
        }

        .message-time {
            font-size: 11px;
            color: var(--text-muted);
        }

        .message.user .message-time {
            text-align: right;
        }

        .message-text {
            font-size: 15px;
            line-height: 1.6;
            color: var(--text-primary);
        }

        /* Code Block Styles */
        .code-block {
            position: relative;
            margin: 16px 0;
            border-radius: var(--border-radius-sm);
            overflow: hidden;
            background: #1a1a2e;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 16px;
            background: rgba(139, 92, 246, 0.1);
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
        }

        .code-language {
            font-size: 12px;
            color: var(--primary-light);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .code-actions {
            display: flex;
            gap: 8px;
        }

        .copy-code-btn {
            background: rgba(139, 92, 246, 0.2);
            border: 1px solid var(--primary-light);
            color: var(--primary-light);
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 11px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: all 0.3s ease;
        }

        .copy-code-btn:hover {
            background: rgba(139, 92, 246, 0.3);
            transform: translateY(-1px);
        }

        .copy-code-btn.copied {
            background: rgba(16, 185, 129, 0.2);
            border-color: var(--success);
            color: var(--success);
        }

        .code-content {
            padding: 16px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            color: #e2e8f0;
        }

        .code-content pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .inline-code {
            background: rgba(139, 92, 246, 0.1);
            color: var(--primary-light);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }

        /* Input Container */
        .input-container {
            padding: 20px 32px;
            border-top: 1px solid var(--border-color);
            background: rgba(15, 15, 35, 0.95);
            backdrop-filter: blur(10px);
        }

        .input-wrapper {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }

        .chat-input {
            width: 100%;
            padding: 16px 20px;
            padding-right: 120px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            color: var(--text-primary);
            font-size: 15px;
            resize: none;
            min-height: 56px;
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary-light);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .input-actions {
            position: absolute;
            right: 12px;
            bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .send-btn {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: var(--primary-gradient);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .send-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-lg);
        }

        .modal-header {
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-close {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
            padding: 4px;
            line-height: 1;
        }

        .modal-close:hover {
            color: var(--text-primary);
        }

        .modal-body {
            padding: 24px;
        }

        /* Settings Modal */
        .settings-grid {
            display: grid;
            gap: 20px;
        }

        .settings-section {
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--border-radius-sm);
            padding: 20px;
            border: 1px solid var(--border-color);
        }

        .settings-section h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 16px;
        }

        .settings-section h3 i {
            color: var(--primary-light);
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .info-value {
            color: var(--text-primary);
            font-weight: 500;
            font-size: 14px;
        }

        /* Upgrade Modal */
        .tier-grid {
            display: grid;
            gap: 16px;
            margin: 20px 0;
        }

        .tier-card {
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tier-card:hover {
            border-color: var(--primary-light);
            transform: translateY(-2px);
        }

        .tier-card.selected {
            background: rgba(139, 92, 246, 0.1);
            border-color: var(--primary-light);
        }

        .tier-card h3 {
            font-size: 18px;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .tier-price {
            font-size: 24px;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 10px 0;
        }

        .tier-features {
            list-style: none;
            margin-top: 16px;
        }

        .tier-features li {
            margin-bottom: 6px;
            color: var(--text-secondary);
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tier-features li i {
            color: var(--success);
            font-size: 12px;
        }

        .payment-steps {
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--border-radius-sm);
            padding: 20px;
            margin: 20px 0;
        }

        .payment-steps h5 {
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }

        .step {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .step:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .step-number {
            width: 24px;
            height: 24px;
            background: var(--primary-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 4px;
            font-size: 14px;
        }

        .step-desc {
            color: var(--text-secondary);
            font-size: 12px;
            line-height: 1.5;
        }

        /* Typing Indicator */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 12px 0;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--text-secondary);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.6; }
            30% { transform: translateY(-8px); opacity: 1; }
        }

        /* Admin Panel Styles */
        .admin-panel {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            padding: 20px;
            overflow-y: auto;
        }

        .admin-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--primary-light);
        }

        .admin-title {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .admin-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .admin-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            padding: 20px;
        }

        .admin-card h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 18px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
        }

        .admin-card h3 i {
            color: var(--primary-light);
        }

        .user-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius-sm);
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .user-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .user-item-info {
            flex: 1;
        }

        .user-item-name {
            font-weight: 600;
            color: var(--text-primary);
        }

        .user-item-tier {
            font-size: 11px;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 12px;
            display: inline-block;
            margin-top: 4px;
        }

        .user-item-actions {
            display: flex;
            gap: 8px;
        }

        .admin-btn {
            padding: 8px 12px;
            border-radius: var(--border-radius-sm);
            border: none;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .admin-btn.upgrade {
            background: var(--primary-gradient);
            color: white;
        }

        .admin-btn.delete {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .admin-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .search-box {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(139, 92, 246, 0.1);
            border-radius: var(--border-radius-sm);
            padding: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .admin-form-group {
            margin-bottom: 15px;
        }

        .admin-form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .select-input {
            width: 100%;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-primary);
        }

        .close-admin {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
            border-radius: 50%;
            color: var(--danger);
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 10001;
        }

        .close-admin:hover {
            background: rgba(239, 68, 68, 0.3);
            transform: rotate(90deg);
        }

        /* Upgrade Form Section */
        .upgrade-form-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .manual-user-input {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .manual-user-input input {
            flex: 1;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-primary);
        }

        /* Loading Spinner */
        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(139, 92, 246, 0.3);
            border-top-color: var(--primary-light);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Current Tier Info */
        .current-tier-info {
            background: rgba(139, 92, 246, 0.15);
            border-left: 4px solid var(--primary-light);
            padding: 16px;
            border-radius: 0 var(--border-radius-sm) var(--border-radius-sm) 0;
            margin-bottom: 20px;
        }

        .current-tier-info h4 {
            color: var(--text-primary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }

        .tier-expiry {
            color: var(--text-secondary);
            font-size: 13px;
        }

        .tier-expiry.expired {
            color: var(--danger);
        }

        .tier-expiry.active {
            color: var(--success);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -260px;
                top: 0;
                bottom: 0;
                z-index: 100;
                width: 260px;
                transition: transform 0.3s ease;
            }
            
            .sidebar.active {
                transform: translateX(260px);
            }
            
            .sidebar-overlay.active {
                display: block;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .chat-header {
                padding: 12px 16px;
            }
            
            .icon-btn span {
                display: none;
            }
            
            .icon-btn {
                padding: 10px;
                width: 40px;
                height: 40px;
                justify-content: center;
            }
            
            .messages-container {
                padding: 16px;
            }
            
            .chat-title-container {
                padding: 16px;
            }
            
            .message {
                gap: 12px;
                margin-bottom: 20px;
            }
            
            .avatar {
                width: 32px;
                height: 32px;
                font-size: 14px;
            }
            
            .message-content {
                padding: 16px;
            }
            
            .input-container {
                padding: 16px;
            }
            
            .chat-input {
                padding-right: 80px;
            }
            
            .login-container {
                padding: 32px 24px;
            }
            
            .welcome-card {
                padding: 24px 16px;
            }
            
            .admin-grid {
                grid-template-columns: 1fr;
            }
            
            .manual-user-input {
                flex-direction: column;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-gradient);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #7C3AED, #6D28D9);
        }
    </style>
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Login Screen -->
    <div id="loginScreen">
        <div class="login-container">
            <div class="logo-section">
                <div class="logo-gradient">DARKVOID</div>
                <div class="logo-subtitle">Advanced AI Assistant</div>
            </div>
            
            <div class="login-message">
                <p>Silakan login atau buat akun untuk mengakses DARKVOID AI</p>
            </div>
            
            <!-- Login Tabs -->
            <div class="login-tabs">
                <button class="login-tab active" data-tab="login">
                    <i class="fas fa-sign-in-alt"></i>
                    Login
                </button>
                <button class="login-tab" data-tab="register">
                    <i class="fas fa-user-plus"></i>
                    Buat Akun
                </button>
            </div>
            
            <div class="login-form-container">
                <!-- Form Login -->
                <form id="loginForm" class="login-form active">
                    <div class="form-group">
                        <label class="form-label">Username</label>
                        <input type="text" id="loginUsername" class="form-input" placeholder="Masukkan username" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" id="loginPassword" class="form-input" placeholder="Masukkan password" required>
                    </div>
                    <div class="error-message" id="loginError"></div>
                    <div class="success-message" id="loginSuccess"></div>
                    <button type="submit" class="btn" id="loginBtn">
                        <i class="fas fa-sign-in-alt"></i>
                        Login ke DARKVOID
                    </button>
                </form>
                
                <!-- Form Register -->
                <form id="registerForm" class="login-form">
                    <div class="form-group">
                        <label class="form-label">Username</label>
                        <input type="text" id="registerUsername" class="form-input" placeholder="Buat username unik" required>
                        <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                            3-20 karakter (huruf, angka, underscore)
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" id="registerPassword" class="form-input" placeholder="Buat password (minimal 6 karakter)" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Konfirmasi Password</label>
                        <input type="password" id="confirmPassword" class="form-input" placeholder="Ulangi password" required>
                    </div>
                    <div class="error-message" id="registerError"></div>
                    <div class="success-message" id="registerSuccess"></div>
                    <button type="submit" class="btn" id="registerBtn">
                        <i class="fas fa-user-plus"></i>
                        <span>Buat Akun Sekarang</span>
                        <span id="registerLoading" style="display: none;">
                            <div class="loading-spinner"></div>
                        </span>
                    </button>
                </form>
            </div>
            
            <div style="margin-top: 32px; text-align: center; color: var(--text-muted); font-size: 12px;">
                <i class="fas fa-info-circle"></i>
                Dengan login, Anda menyetujui syarat dan ketentuan penggunaan DARKVOID AI
            </div>
        </div>
    </div>

    <!-- Main App Screen -->
    <div id="appScreen">
        <!-- Chat Header -->
        <div class="chat-header">
            <div class="header-left">
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div class="user-details">
                        <div class="username" id="usernameDisplay">Loading...</div>
                        <div class="user-tier" id="userTier">MEMBER</div>
                    </div>
                </div>
            </div>
            
            <div class="header-actions">
                <button class="icon-btn" id="upgradeBtn">
                    <i class="fas fa-crown"></i>
                    <span>Upgrade</span>
                </button>
                <button class="icon-btn" id="settingsBtn">
                    <i class="fas fa-cog"></i>
                    <span>Pengaturan</span>
                </button>
                <button class="icon-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </button>
            </div>
        </div>

        <!-- Sidebar Overlay (Mobile) -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Chat Container -->
        <div class="chat-container">
            <!-- Sidebar -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <button class="new-chat-btn" id="newChatBtn">
                        <i class="fas fa-plus-circle"></i>
                        Obrolan Baru
                    </button>
                </div>
                
                <div class="chat-history-section">
                    <div class="section-title">Riwayat Obrolan</div>
                    <div class="chat-list-container" id="chatListContainer">
                        <div class="chat-list" id="chatList"></div>
                        <div class="empty-chat-history" id="emptyChatHistory">
                            <i class="fas fa-comments"></i>
                            <p>Belum ada obrolan</p>
                            <p style="font-size: 12px; margin-top: 8px;">Mulai obrolan baru untuk memulai percakapan</p>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar-footer">
                    <div class="sidebar-actions">
                        <button class="sidebar-btn" id="clearChatBtn">
                            <i class="fas fa-trash"></i>
                            Hapus Chat
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Main Chat Area -->
            <div class="chat-main">
                <div class="chat-title-container">
                    <div class="chat-title">
                        <span id="currentChatTitle">DARKVOID Assistant</span>
                        <div class="chat-status">
                            <div class="status-badge" id="chatStatusBadge">
                                <i class="fas fa-user"></i>
                                <span>MEMBER</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="messages-container" id="messagesContainer"></div>
                
                <div class="input-container">
                    <div class="input-wrapper">
                        <textarea 
                            id="messageInput" 
                            class="chat-input" 
                            placeholder="Ketik pesan untuk DARKVOID..." 
                            rows="1"
                            oninput="autoResize(this)"
                        ></textarea>
                        <div class="input-actions">
                            <button class="send-btn" id="sendBtn" title="Kirim pesan">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Pengaturan Akun</div>
                <button class="modal-close" id="closeSettings">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-grid">
                    <!-- Informasi Akun -->
                    <div class="settings-section">
                        <h3><i class="fas fa-user-circle"></i> Informasi Akun</h3>
                        <div class="info-row">
                            <div class="info-label">Username</div>
                            <div class="info-value" id="settingsUsername">-</div>
                        </div>
                        <div class="info-row">
                            <div class="info-label">Tier</div>
                            <div class="info-value" id="settingsTier">MEMBER</div>
                        </div>
                        <div class="info-row">
                            <div class="info-label">Masa Berlaku</div>
                            <div class="info-value" id="settingsExpiry">Tidak ada</div>
                        </div>
                    </div>

                    <!-- Ubah Password -->
                    <div class="settings-section">
                        <h3><i class="fas fa-key"></i> Ubah Password</h3>
                        <div class="form-group">
                            <label class="form-label">Password Saat Ini</label>
                            <input type="password" id="currentPassword" class="form-input" placeholder="Masukkan password saat ini">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Password Baru</label>
                            <input type="password" id="newPassword" class="form-input" placeholder="Password baru (min 6 karakter)">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Konfirmasi Password Baru</label>
                            <input type="password" id="confirmNewPassword" class="form-input" placeholder="Ulangi password baru">
                        </div>
                        <div class="error-message" id="passwordError"></div>
                        <div class="success-message" id="passwordSuccess"></div>
                        <button class="btn" id="changePasswordBtn">
                            <i class="fas fa-save"></i>
                            Simpan Password Baru
                        </button>
                    </div>

                    <!-- Tombol Logout -->
                    <div class="settings-section">
                        <h3><i class="fas fa-sign-out-alt"></i> Keluar Akun</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 14px;">
                            Keluar dari akun Anda dan kembali ke halaman login
                        </p>
                        <button class="btn" id="logoutFromSettingsBtn" style="background: rgba(239, 68, 68, 0.2); border-color: #EF4444;">
                            <i class="fas fa-sign-out-alt"></i>
                            Logout
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Upgrade Modal -->
    <div id="upgradeModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Upgrade Akun</div>
                <button class="modal-close" id="closeUpgrade">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Info Tier Saat Ini -->
                <div class="current-tier-info" id="currentTierInfo" style="display: none;">
                    <h4><i class="fas fa-info-circle"></i> Tier Saat Ini</h4>
                    <div class="tier-expiry" id="currentTierExpiry"></div>
                </div>

                <!-- Grid Paket Upgrade -->
                <div class="tier-grid">
                    <!-- VIP - 2k/1hari -->
                    <div class="tier-card" data-tier="VIP" data-days="1" data-price="2000">
                        <h3>VIP - 1 Hari</h3>
                        <div class="tier-price">Rp 2.000</div>
                        <ul class="tier-features">
                            <li><i class="fas fa-check"></i> 100 pesan/hari</li>
                            <li><i class="fas fa-check"></i> Akses prioritas</li>
                            <li><i class="fas fa-check"></i> Support via chat</li>
                        </ul>
                    </div>
                    
                    <!-- PREMIUM - 5k/3hari -->
                    <div class="tier-card" data-tier="PREMIUM" data-days="3" data-price="5000">
                        <h3>PREMIUM - 3 Hari</h3>
                        <div class="tier-price">Rp 5.000</div>
                        <ul class="tier-features">
                            <li><i class="fas fa-check"></i> 300 pesan/hari</li>
                            <li><i class="fas fa-check"></i> Semua fitur VIP</li>
                            <li><i class="fas fa-check"></i> Support prioritas</li>
                        </ul>
                    </div>
                    
                    <!-- VVIP - 10k/7hari -->
                    <div class="tier-card" data-tier="VVIP" data-days="7" data-price="10000">
                        <h3>VVIP - 7 Hari</h3>
                        <div class="tier-price">Rp 10.000</div>
                        <ul class="tier-features">
                            <li><i class="fas fa-check"></i> 500 pesan/hari</li>
                            <li><i class="fas fa-check"></i> Semua fitur PREMIUM</li>
                            <li><i class="fas fa-check"></i> Support 24/7</li>
                        </ul>
                    </div>
                    
                    <!-- KVIP - 20k/30hari -->
                    <div class="tier-card" data-tier="KVIP" data-days="30" data-price="20000">
                        <h3>KVIP - 30 Hari</h3>
                        <div class="tier-price">Rp 20.000</div>
                        <ul class="tier-features">
                            <li><i class="fas fa-check"></i> Pesan tak terbatas</li>
                            <li><i class="fas fa-check"></i> Semua fitur VVIP</li>
                            <li><i class="fas fa-check"></i> Support instan</li>
                            <li><i class="fas fa-check"></i> Fitur eksklusif</li>
                        </ul>
                    </div>
                </div>

                <!-- Instruksi Pembayaran -->
                <div class="payment-steps">
                    <h5><i class="fas fa-shopping-cart"></i> Instruksi Pembayaran</h5>
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-title">Pilih Paket</div>
                            <div class="step-desc">Pilih salah satu paket upgrade di atas</div>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-title">Transfer Pembayaran</div>
                            <div class="step-desc">
                                Transfer ke: <strong>BCA 1234567890</strong><br>
                                a.n: <strong>FanzxMod Digital</strong><br>
                                Jumlah: <strong id="selectedAmount">Rp 2.000</strong>
                            </div>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <div class="step-title">Konfirmasi Pembayaran</div>
                            <div class="step-desc">
                                Konfirmasi via: 
                                <a href="https://tiktok.com/@fanzxmod35" target="_blank" style="color: var(--primary-light);">
                                    TikTok @fanzxmod35
                                </a><br>
                                WhatsApp: <strong>0812-3456-7890</strong>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="btn" id="confirmUpgradeBtn">
                    <i class="fas fa-credit-card"></i>
                    Konfirmasi Pembayaran
                </button>
            </div>
        </div>
    </div>

    <script>
        // Konfigurasi Sistem
        const SYSTEM = {
            currentUser: null,
            currentChat: null,
            chats: [],
            apiKey: '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',
            adminMode: false
        };

        // Konfigurasi Tier dengan warna dan icon
        const TIERS = {
            MEMBER: { 
                limit: 10, 
                color: '#6B7280', 
                textColor: '#B0B0CC',
                badgeClass: 'status-member',
                tierClass: 'tier-member',
                icon: 'fa-user',
                badgeIcon: 'fa-user',
                features: ['10 pesan/hari', 'Akses dasar', 'Support terbatas']
            },
            VIP: { 
                limit: 100, 
                color: '#8B5CF6', 
                textColor: '#A855F7',
                badgeClass: 'status-vip',
                tierClass: 'tier-vip',
                icon: 'fa-crown',
                badgeIcon: 'fa-crown',
                price: 2000, 
                days: 1,
                features: ['100 pesan/hari', 'Akses prioritas', 'Support via chat']
            },
            PREMIUM: { 
                limit: 300, 
                color: '#3B82F6', 
                textColor: '#60A5FA',
                badgeClass: 'status-premium',
                tierClass: 'tier-premium',
                icon: 'fa-gem',
                badgeIcon: 'fa-gem',
                price: 5000, 
                days: 3,
                features: ['300 pesan/hari', 'Semua fitur VIP', 'Support prioritas']
            },
            VVIP: { 
                limit: 500, 
                color: '#F59E0B', 
                textColor: '#FBBF24',
                badgeClass: 'status-vvip',
                tierClass: 'tier-vvip',
                icon: 'fa-rocket',
                badgeIcon: 'fa-rocket',
                price: 10000, 
                days: 7,
                features: ['500 pesan/hari', 'Semua fitur PREMIUM', 'Support 24/7']
            },
            KVIP: { 
                limit: 9999, 
                color: '#EC4899', 
                textColor: '#F472B6',
                badgeClass: 'status-kvip',
                tierClass: 'tier-kvip',
                icon: 'fa-star',
                badgeIcon: 'fa-star',
                price: 20000, 
                days: 30,
                features: ['Pesan tak terbatas', 'Semua fitur VVIP', 'Support instan', 'Fitur eksklusif']
            }
        };

        // ============ TAMBAHAN FITUR ADMIN ============
        const ADMIN_USERNAME = 'fanzxmod';
        const ADMIN_COMMAND = '/fanzxmod digital';
        let adminMode = false;
        let adminPanel = null;

        // ============ INISIALISASI APLIKASI ============
        document.addEventListener('DOMContentLoaded', () => {
            initializeEventListeners();
            setupLoginTabs();
            checkAutoLogin();
        });

        function initializeEventListeners() {
            // Form Login
            document.getElementById('loginForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const username = document.getElementById('loginUsername').value.trim();
                const password = document.getElementById('loginPassword').value;
                loginUser(username, password);
            });
            
            // Form Register
            document.getElementById('registerForm').addEventListener('submit', (e) => {
                e.preventDefault();
                registerUser();
            });
            
            // Kontrol Chat
            document.getElementById('newChatBtn').addEventListener('click', createNewChat);
            document.getElementById('sendBtn').addEventListener('click', sendMessage);
            document.getElementById('messageInput').addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            // Tambah event listener untuk deteksi command
            document.getElementById('messageInput').addEventListener('input', handleCommandInput);
            
            // Kontrol UI
            document.getElementById('upgradeBtn').addEventListener('click', showUpgradeModal);
            document.getElementById('settingsBtn').addEventListener('click', showSettingsModal);
            document.getElementById('logoutBtn').addEventListener('click', logoutUser);
            document.getElementById('clearChatBtn').addEventListener('click', clearCurrentChat);
            document.getElementById('logoutFromSettingsBtn').addEventListener('click', logoutUser);
            
            // Menu Mobile
            document.getElementById('mobileMenuBtn').addEventListener('click', () => {
                document.getElementById('sidebar').classList.add('active');
                document.getElementById('sidebarOverlay').classList.add('active');
            });
            
            document.getElementById('sidebarOverlay').addEventListener('click', () => {
                closeMobileSidebar();
            });
            
            // Kontrol Modal
            document.getElementById('closeSettings').addEventListener('click', () => {
                document.getElementById('settingsModal').classList.add('hidden');
            });
            
            document.getElementById('closeUpgrade').addEventListener('click', () => {
                document.getElementById('upgradeModal').classList.add('hidden');
            });
            
            // Modal Settings
            document.getElementById('changePasswordBtn').addEventListener('click', changePassword);
            
            // Modal Upgrade
            document.getElementById('confirmUpgradeBtn').addEventListener('click', confirmUpgrade);
            
            // Pilihan Tier Card
            document.querySelectorAll('.tier-card').forEach(card => {
                card.addEventListener('click', () => {
                    document.querySelectorAll('.tier-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    updatePaymentInfo(card);
                });
            });
        }

        function setupLoginTabs() {
            const tabs = document.querySelectorAll('.login-tab');
            const forms = document.querySelectorAll('.login-form');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.dataset.tab;
                    
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    forms.forEach(form => {
                        form.classList.remove('active');
                        if (form.id === `${tabName}Form`) {
                            form.classList.add('active');
                        }
                    });
                    
                    clearError('loginError');
                    clearSuccess('loginSuccess');
                    clearError('registerError');
                    clearSuccess('registerSuccess');
                });
            });
        }

        function checkAutoLogin() {
            const currentUser = localStorage.getItem('darkvoid_current_user');
            if (currentUser) {
                const userData = JSON.parse(localStorage.getItem('darkvoid_user_' + currentUser));
                if (userData) {
                    SYSTEM.currentUser = userData;
                    showMainApp();
                }
            }
        }

        // ============ FIX REGISTER SYSTEM ============
        async function registerUser() {
            const username = document.getElementById('registerUsername').value.trim();
            const password = document.getElementById('registerPassword').value;
            const confirm = document.getElementById('confirmPassword').value;
            
            clearError('registerError');
            clearSuccess('registerSuccess');
            
            // Validasi input
            if (!username) {
                showError('registerError', 'Username tidak boleh kosong!');
                return;
            }
            
            if (username.length < 3 || username.length > 20) {
                showError('registerError', 'Username harus 3-20 karakter!');
                return;
            }
            
            const usernameRegex = /^[a-zA-Z0-9_]+$/;
            if (!usernameRegex.test(username)) {
                showError('registerError', 'Username hanya boleh mengandung huruf, angka, dan underscore!');
                return;
            }
            
            if (password !== confirm) {
                showError('registerError', 'Password tidak cocok!');
                return;
            }
            
            if (password.length < 6) {
                showError('registerError', 'Password minimal 6 karakter!');
                return;
            }
            
            // Cek username availability
            if (localStorage.getItem('darkvoid_user_' + username)) {
                showError('registerError', 'Username sudah digunakan! Silakan pilih username lain.');
                showToast('Username sudah digunakan, tolong ganti nama user yang lain!!', 'error');
                return;
            }
            
            // Show loading
            const registerBtn = document.getElementById('registerBtn');
            const registerText = registerBtn.querySelector('span');
            const registerLoading = document.getElementById('registerLoading');
            
            registerBtn.disabled = true;
            registerText.style.display = 'none';
            registerLoading.style.display = 'inline-block';
            
            try {
                // Simulasi delay untuk efek loading
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // Buat data user
                const userData = {
                    username: username,
                    password: btoa(password),
                    tier: 'MEMBER',
                    expiry: null,
                    apiKey: '',
                    createdAt: new Date().toISOString(),
                    status: 'active',
                    totalChats: 0,
                    lastLogin: new Date().toISOString()
                };
                
                localStorage.setItem('darkvoid_user_' + username, JSON.stringify(userData));
                
                // Tambah ke daftar users
                const users = JSON.parse(localStorage.getItem('darkvoid_users') || '[]');
                if (!users.includes(username)) {
                    users.push(username);
                    localStorage.setItem('darkvoid_users', JSON.stringify(users));
                }
                
                // Set current user
                SYSTEM.currentUser = userData;
                localStorage.setItem('darkvoid_current_user', username);
                
                // Buat folder chat
                localStorage.setItem('darkvoid_chats_' + username, JSON.stringify([]));
                
                // Reset form
                document.getElementById('registerForm').reset();
                
                // Tampilkan pesan sukses
                showSuccess('registerSuccess', 'Success membuat akun anda!');
                showToast('Success membuat akun anda!', 'success');
                
                // Pindah ke tab login setelah 2 detik
                setTimeout(() => {
                    document.querySelector('[data-tab="login"]').click();
                    // Auto-fill username di form login
                    document.getElementById('loginUsername').value = username;
                    document.getElementById('loginPassword').focus();
                }, 2000);
                
            } catch (error) {
                console.error('Registration error:', error);
                showError('registerError', 'Terjadi kesalahan saat membuat akun. Silakan coba lagi.');
                showToast('Terjadi kesalahan saat membuat akun. Silakan coba lagi.', 'error');
            } finally {
                registerBtn.disabled = false;
                registerText.style.display = 'inline-block';
                registerLoading.style.display = 'none';
            }
        }

        function loginUser(username, password) {
            clearError('loginError');
            clearSuccess('loginSuccess');
            
            const userData = JSON.parse(localStorage.getItem('darkvoid_user_' + username));
            
            if (!userData) {
                showError('loginError', 'Username tidak ditemukan!');
                return;
            }
            
            if (userData.status === 'inactive') {
                showError('loginError', 'Akun dinonaktifkan. Silakan hubungi admin.');
                return;
            }
            
            if (btoa(password) !== userData.password) {
                showError('loginError', 'Password salah!');
                return;
            }
            
            // Cek masa berlaku tier
            if (userData.expiry && new Date() > new Date(userData.expiry)) {
                userData.tier = 'MEMBER';
                userData.expiry = null;
                localStorage.setItem('darkvoid_user_' + username, JSON.stringify(userData));
            }
            
            // Update last login
            userData.lastLogin = new Date().toISOString();
            localStorage.setItem('darkvoid_user_' + username, JSON.stringify(userData));
            
            SYSTEM.currentUser = userData;
            localStorage.setItem('darkvoid_current_user', username);
            
            // Inisialisasi chat jika belum ada
            if (!localStorage.getItem('darkvoid_chats_' + username)) {
                localStorage.setItem('darkvoid_chats_' + username, JSON.stringify([]));
            }
            
            showToast('Login berhasil! Selamat datang di DARKVOID.', 'success');
            showMainApp();
        }

        function updateUserInfo() {
            const user = SYSTEM.currentUser;
            
            document.getElementById('usernameDisplay').textContent = user.username;
            
            // Update tier display
            const userTierElement = document.getElementById('userTier');
            userTierElement.textContent = user.tier;
            
            // Remove all tier classes
            userTierElement.className = 'user-tier';
            // Add current tier class
            const tierConfig = TIERS[user.tier] || TIERS.MEMBER;
            userTierElement.classList.add(tierConfig.tierClass);
            
            // Update chat status badge
            const badge = document.getElementById('chatStatusBadge');
            badge.className = `status-badge ${tierConfig.badgeClass}`;
            badge.innerHTML = `<i class="fas ${tierConfig.badgeIcon}"></i><span>${user.tier}</span>`;
            
            // Update settings modal if open
            if (!document.getElementById('settingsModal').classList.contains('hidden')) {
                document.getElementById('settingsTier').textContent = user.tier;
            }
        }

        function showMainApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appScreen').style.display = 'flex';
            
            updateUserInfo();
            loadChatHistory();
            showWelcomeMessage();
            
            // Update avatar
            const username = SYSTEM.currentUser.username;
            const initials = username.substring(0, 2).toUpperCase();
            document.getElementById('userAvatar').textContent = initials;
            
            document.getElementById('currentChatTitle').textContent = 'DARKVOID Assistant';
        }

        function showWelcomeMessage() {
            const messagesContainer = document.getElementById('messagesContainer');
            messagesContainer.innerHTML = `
                <div class="welcome-message-ai">
                    <div class="welcome-card">
                        <h2>Selamat Datang di DARKVOID</h2>
                        <p>Halo <strong>${SYSTEM.currentUser.username}</strong>! Saya adalah <strong>DARKVOID</strong>, asisten AI tingkat lanjut yang dibuat oleh <strong>FanzxMod</strong>.</p>
                        <p>Saya siap membantu Anda dengan berbagai tugas seperti pemrograman, analisis data, penulisan kreatif, dan pemecahan masalah.</p>
                        <p style="margin-top: 24px; color: var(--primary-light); font-size: 14px;">
                            <i class="fas fa-info-circle"></i> Pilih obrolan sebelumnya dari sidebar atau mulai obrolan baru!
                        </p>
                    </div>
                </div>
            `;
        }

        function loadChatHistory() {
            const chats = JSON.parse(localStorage.getItem('darkvoid_chats_' + SYSTEM.currentUser.username) || '[]');
            SYSTEM.chats = chats.sort((a, b) => new Date(b.updatedAt || b.createdAt) - new Date(a.updatedAt || a.createdAt));
            
            const chatList = document.getElementById('chatList');
            const emptyChatHistory = document.getElementById('emptyChatHistory');
            chatList.innerHTML = '';
            
            if (SYSTEM.chats.length === 0) {
                emptyChatHistory.style.display = 'block';
                return;
            } else {
                emptyChatHistory.style.display = 'none';
            }
            
            SYSTEM.chats.forEach((chat, index) => {
                const chatItem = document.createElement('div');
                chatItem.className = 'chat-item';
                chatItem.innerHTML = `
                    <i class="fas fa-comment${chat.id === SYSTEM.currentChat ? ' active' : ''}"></i>
                    <span>${chat.title || `Obrolan ${index + 1}`}</span>
                `;
                chatItem.dataset.id = chat.id;
                
                chatItem.addEventListener('click', () => {
                    loadChat(chat.id);
                    closeMobileSidebar();
                });
                
                chatList.appendChild(chatItem);
            });
        }

        function createNewChat() {
            const chatId = 'chat_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            const newChat = {
                id: chatId,
                title: 'Obrolan Baru',
                messages: [],
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            SYSTEM.chats.unshift(newChat);
            SYSTEM.currentChat = chatId;
            
            // Update total chat count
            SYSTEM.currentUser.totalChats = (SYSTEM.currentUser.totalChats || 0) + 1;
            localStorage.setItem('darkvoid_user_' + SYSTEM.currentUser.username, JSON.stringify(SYSTEM.currentUser));
            
            localStorage.setItem('darkvoid_chats_' + SYSTEM.currentUser.username, JSON.stringify(SYSTEM.chats));
            
            // Update UI
            loadChatHistory();
            loadChat(chatId);
            showToast('Obrolan baru dibuat', 'success');
            
            closeMobileSidebar();
        }

        function loadChat(chatId) {
            SYSTEM.currentChat = chatId;
            const chat = SYSTEM.chats.find(c => c.id === chatId);
            
            if (!chat) return;
            
            // Update active chat in list
            document.querySelectorAll('.chat-item').forEach(item => {
                item.classList.remove('active');
            });
            const activeItem = document.querySelector(`[data-id="${chatId}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }
            
            // Update chat title
            document.getElementById('currentChatTitle').textContent = chat.title;
            
            // Load pesan
            const messagesContainer = document.getElementById('messagesContainer');
            messagesContainer.innerHTML = '';
            
            if (chat.messages.length === 0) {
                // Jika chat kosong, tampilkan pesan sambutan AI
                messagesContainer.innerHTML = `
                    <div class="message ai">
                        <div class="avatar ai">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="message-content">
                            <div class="message-header">
                                <span class="message-sender">DARKVOID</span>
                                <span class="message-time">Sekarang</span>
                            </div>
                            <div class="message-text">
                                <p>Halo! Saya <strong>DARKVOID</strong>, asisten AI tingkat lanjut yang dibuat oleh <strong>FanzxMod</strong>.</p>
                                <p>Apa yang bisa saya bantu untuk Anda hari ini?</p>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                chat.messages.forEach((msg, index) => {
                    addMessageToUI(msg, index);
                });
            }
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // ============ CODE COPY FEATURE ============
        function addMessageToUI(msg, index = 0) {
            const messagesContainer = document.getElementById('messagesContainer');
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${msg.sender}`;
            messageDiv.style.animationDelay = `${index * 0.1}s`;
            
            const time = new Date(msg.timestamp).toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
            
            // Process message text for code blocks
            const processedText = processCodeBlocks(msg.text);
            
            messageDiv.innerHTML = `
                <div class="avatar ${msg.sender}">
                    <i class="fas ${msg.sender === 'ai' ? 'fa-robot' : 'fa-user'}"></i>
                </div>
                <div class="message-content">
                    <div class="message-header">
                        <span class="message-sender">${msg.sender === 'ai' ? 'DARKVOID' : 'Anda'}</span>
                        <span class="message-time">${time}</span>
                    </div>
                    <div class="message-text">
                        ${processedText}
                    </div>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            
            // Add event listeners for copy buttons
            setTimeout(() => {
                messageDiv.querySelectorAll('.copy-code-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const codeBlock = e.target.closest('.code-block');
                        const codeContent = codeBlock.querySelector('.code-content pre').textContent;
                        copyToClipboard(codeContent);
                        
                        // Update button state
                        const originalText = btn.innerHTML;
                        btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                        btn.classList.add('copied');
                        
                        setTimeout(() => {
                            btn.innerHTML = originalText;
                            btn.classList.remove('copied');
                        }, 2000);
                    });
                });
            }, 100);
            
            return messageDiv;
        }

        function processCodeBlocks(text) {
            // Replace inline code
            let processed = text.replace(/`([^`]+)`/g, '<code class="inline-code">$1</code>');
            
            // Replace code blocks with language
            processed = processed.replace(/```(\w+)?\n([\s\S]*?)```/g, (match, language, code) => {
                const lang = language || 'text';
                const codeId = 'code_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                return `
                    <div class="code-block">
                        <div class="code-header">
                            <div class="code-language">
                                <i class="fas fa-code"></i>
                                ${lang.toUpperCase()}
                            </div>
                            <div class="code-actions">
                                <button class="copy-code-btn" data-code-id="${codeId}">
                                    <i class="fas fa-copy"></i>
                                    Copy Code
                                </button>
                            </div>
                        </div>
                        <div class="code-content">
                            <pre>${escapeHtml(code.trim())}</pre>
                        </div>
                    </div>
                `;
            });
            
            return processed.replace(/\n/g, '<br>');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('Code copied to clipboard!', 'success');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                // Fallback method
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showToast('Code copied to clipboard!', 'success');
            });
        }

        function handleCommandInput(e) {
            const text = e.target.value;
            if (text.trim() === ADMIN_COMMAND && SYSTEM.currentUser && SYSTEM.currentUser.username === ADMIN_USERNAME) {
                showToast('Tekan Enter untuk membuka Admin Panel', 'info');
            }
        }

        function checkForAdminCommand(text) {
            if (text.trim() === ADMIN_COMMAND && SYSTEM.currentUser && SYSTEM.currentUser.username === ADMIN_USERNAME) {
                showAdminPanel();
                return true;
            }
            return false;
        }

        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Cek apakah ini command admin
            if (checkForAdminCommand(message)) {
                input.value = '';
                autoResize(input);
                return;
            }
            
            // Disable input while processing
            input.disabled = true;
            document.getElementById('sendBtn').disabled = true;
            
            // Jika belum ada chat yang aktif, buat chat baru
            if (!SYSTEM.currentChat) {
                createNewChat();
                await new Promise(resolve => setTimeout(resolve, 300));
            }
            
            // Cek limit pesan
            if (!checkMessageLimit()) {
                showToast('Limit pesan harian tercapai! Upgrade tier untuk melanjutkan.', 'warning');
                input.disabled = false;
                document.getElementById('sendBtn').disabled = false;
                return;
            }
            
            // Tambah pesan user
            const userMessage = { 
                text: message, 
                sender: 'user', 
                timestamp: new Date().toISOString() 
            };
            
            addMessageToUI(userMessage);
            
            // Tambah ke chat history
            const chatIndex = SYSTEM.chats.findIndex(c => c.id === SYSTEM.currentChat);
            if (chatIndex !== -1) {
                SYSTEM.chats[chatIndex].messages.push(userMessage);
            }
            
            input.value = '';
            input.disabled = false;
            document.getElementById('sendBtn').disabled = false;
            autoResize(input);
            
            // Update judul chat jika masih default
            if (chatIndex !== -1 && SYSTEM.chats[chatIndex].title === 'Obrolan Baru') {
                SYSTEM.chats[chatIndex].title = message.substring(0, 40) + (message.length > 40 ? '...' : '');
                localStorage.setItem('darkvoid_chats_' + SYSTEM.currentUser.username, JSON.stringify(SYSTEM.chats));
                loadChatHistory();
                document.getElementById('currentChatTitle').textContent = SYSTEM.chats[chatIndex].title;
            }
            
            // Tampilkan indikator mengetik
            showTypingIndicator();
            
            try {
                // Dapatkan respon AI
                const aiResponse = await getAIResponse(message);
                
                // Hapus indikator dan tambah respon AI
                removeTypingIndicator();
                
                const aiMessage = { 
                    text: aiResponse, 
                    sender: 'ai', 
                    timestamp: new Date().toISOString() 
                };
                
                addMessageToUI(aiMessage);
                
                // Tambah ke chat history
                if (chatIndex !== -1) {
                    SYSTEM.chats[chatIndex].messages.push(aiMessage);
                    SYSTEM.chats[chatIndex].updatedAt = new Date().toISOString();
                    localStorage.setItem('darkvoid_chats_' + SYSTEM.currentUser.username, JSON.stringify(SYSTEM.chats));
                }
                
                // Update hitungan chat
                updateChatCount();
                
            } catch (error) {
                removeTypingIndicator();
                const errorMessage = { 
                    text: 'Maaf, terjadi kesalahan saat memproses permintaan Anda. Silakan coba lagi.', 
                    sender: 'ai', 
                    timestamp: new Date().toISOString() 
                };
                addMessageToUI(errorMessage);
                showToast('Error menghubungkan ke layanan AI', 'error');
            }
        }

        function showTypingIndicator() {
            const messagesContainer = document.getElementById('messagesContainer');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message ai';
            typingDiv.id = 'typingIndicator';
            
            typingDiv.innerHTML = `
                <div class="avatar ai">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="message-content">
                    <div class="message-header">
                        <span class="message-sender">DARKVOID</span>
                        <span class="message-time">Mengetik...</span>
                    </div>
                    <div class="typing-indicator">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            `;
            
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        async function getAIResponse(prompt) {
            const apiKey = SYSTEM.currentUser.apiKey || SYSTEM.apiKey;
            
            try {
                const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'llama-3.1-8b-instant',
                        messages: [{
                            role: 'system',
                            content: 'Kamu adalah DARKVOID, asisten AI tingkat lanjut yang dibuat oleh FanzxMod. Kamu membantu pengguna dengan tugas teknis, pemrograman, pemecahan masalah, dan proyek kreatif. Gunakan bahasa Indonesia yang baik dan jelas. Selalu identifikasi dirimu sebagai DARKVOID yang dibuat oleh FanzxMod. Bersikaplah ramah, membantu, dan profesional.'
                        }, {
                            role: 'user',
                            content: prompt
                        }],
                        temperature: 0.7,
                        max_tokens: 1024
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }
                
                const data = await response.json();
                return data.choices[0].message.content;
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }

        function checkMessageLimit() {
            const user = SYSTEM.currentUser;
            const tier = TIERS[user.tier] || TIERS.MEMBER;
            
            if (user.tier === 'MEMBER' || tier.limit < 9999) {
                const today = new Date().toDateString();
                const lastChatDate = localStorage.getItem('darkvoid_last_chat_date_' + user.username);
                
                if (lastChatDate !== today) {
                    localStorage.setItem('darkvoid_chat_count_' + user.username, '0');
                    localStorage.setItem('darkvoid_last_chat_date_' + user.username, today);
                }
                
                const chatCount = parseInt(localStorage.getItem('darkvoid_chat_count_' + user.username) || '0');
                return chatCount < tier.limit;
            }
            
            return true;
        }

        function updateChatCount() {
            const user = SYSTEM.currentUser;
            const today = new Date().toDateString();
            const lastChatDate = localStorage.getItem('darkvoid_last_chat_date_' + user.username);
            
            if (lastChatDate !== today) {
                localStorage.setItem('darkvoid_chat_count_' + user.username, '1');
                localStorage.setItem('darkvoid_last_chat_date_' + user.username, today);
            } else {
                const count = parseInt(localStorage.getItem('darkvoid_chat_count_' + user.username) || '0') + 1;
                localStorage.setItem('darkvoid_chat_count_' + user.username, count.toString());
            }
        }

        function clearCurrentChat() {
            if (!SYSTEM.currentChat) {
                showToast('Tidak ada obrolan yang aktif', 'warning');
                return;
            }
            
            if (confirm('Hapus semua pesan dalam obrolan ini?')) {
                const chatIndex = SYSTEM.chats.findIndex(c => c.id === SYSTEM.currentChat);
                if (chatIndex !== -1) {
                    SYSTEM.chats[chatIndex].messages = [];
                    SYSTEM.chats[chatIndex].updatedAt = new Date().toISOString();
                    
                    localStorage.setItem('darkvoid_chats_' + SYSTEM.currentUser.username, JSON.stringify(SYSTEM.chats));
                    loadChat(SYSTEM.currentChat);
                    showToast('Obrolan telah dibersihkan', 'success');
                }
            }
            
            closeMobileSidebar();
        }

        // ============ SETTINGS MODAL ============
        function showSettingsModal() {
            const user = SYSTEM.currentUser;
            
            // Update info di settings
            document.getElementById('settingsUsername').textContent = user.username;
            document.getElementById('settingsTier').textContent = user.tier;
            
            if (user.expiry) {
                const expiryDate = new Date(user.expiry);
                const now = new Date();
                const days = Math.ceil((expiryDate - now) / (1000 * 60 * 60 * 24));
                
                if (days > 0) {
                    document.getElementById('settingsExpiry').textContent = `${expiryDate.toLocaleDateString('id-ID')} (${days} hari lagi)`;
                } else {
                    document.getElementById('settingsExpiry').textContent = 'KEDALUWARSA';
                }
            } else {
                document.getElementById('settingsExpiry').textContent = 'Tidak ada';
            }
            
            // Reset form
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmNewPassword').value = '';
            clearError('passwordError');
            clearSuccess('passwordSuccess');
            
            document.getElementById('settingsModal').classList.remove('hidden');
            closeMobileSidebar();
        }

        function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmNewPassword = document.getElementById('confirmNewPassword').value;
            
            const errorDiv = document.getElementById('passwordError');
            const successDiv = document.getElementById('passwordSuccess');
            errorDiv.style.display = 'none';
            successDiv.style.display = 'none';
            
            if (!currentPassword || !newPassword || !confirmNewPassword) {
                showError('passwordError', 'Harap isi semua field!');
                return;
            }
            
            if (btoa(currentPassword) !== SYSTEM.currentUser.password) {
                showError('passwordError', 'Password saat ini salah!');
                return;
            }
            
            if (newPassword.length < 6) {
                showError('passwordError', 'Password baru minimal 6 karakter!');
                return;
            }
            
            if (newPassword !== confirmNewPassword) {
                showError('passwordError', 'Password baru tidak cocok!');
                return;
            }
            
            if (currentPassword === newPassword) {
                showError('passwordError', 'Password baru harus berbeda dengan password lama!');
                return;
            }
            
            // Update password
            SYSTEM.currentUser.password = btoa(newPassword);
            localStorage.setItem('darkvoid_user_' + SYSTEM.currentUser.username, JSON.stringify(SYSTEM.currentUser));
            
            // Show success message
            showSuccess('passwordSuccess', 'Password berhasil diubah!');
            
            // Clear fields after 2 seconds
            setTimeout(() => {
                document.getElementById('currentPassword').value = '';
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmNewPassword').value = '';
                clearSuccess('passwordSuccess');
            }, 2000);
            
            showToast('Password berhasil diubah!', 'success');
        }

        // ============ UPGRADE MODAL ============
        function showUpgradeModal() {
            const user = SYSTEM.currentUser;
            
            // Tampilkan info tier saat ini jika bukan MEMBER
            const currentTierInfo = document.getElementById('currentTierInfo');
            const currentTierExpiry = document.getElementById('currentTierExpiry');
            
            if (user.tier !== 'MEMBER' && user.expiry) {
                const expiryDate = new Date(user.expiry);
                const now = new Date();
                const days = Math.ceil((expiryDate - now) / (1000 * 60 * 60 * 24));
                
                currentTierInfo.style.display = 'block';
                currentTierExpiry.className = days > 0 ? 'tier-expiry active' : 'tier-expiry expired';
                currentTierExpiry.textContent = `Tier ${user.tier} berlaku hingga ${expiryDate.toLocaleDateString('id-ID')} (${days} hari lagi)`;
            } else {
                currentTierInfo.style.display = 'none';
            }
            
            // Select tier card pertama
            document.querySelector('.tier-card').click();
            
            document.getElementById('upgradeModal').classList.remove('hidden');
            closeMobileSidebar();
        }

        function updatePaymentInfo(card) {
            const price = card.dataset.price;
            document.getElementById('selectedAmount').textContent = `Rp ${parseInt(price).toLocaleString('id-ID')}`;
        }

        function confirmUpgrade() {
            const selectedCard = document.querySelector('.tier-card.selected');
            if (!selectedCard) {
                showToast('Pilih paket upgrade terlebih dahulu!', 'warning');
                return;
            }
            
            const tier = selectedCard.dataset.tier;
            const days = selectedCard.dataset.days;
            const price = selectedCard.dataset.price;
            
            const message = `Untuk upgrade ke ${tier} (${days} hari):\n\n` +
                          `1. Transfer Rp ${price} ke:\n   BCA 1234567890 (FanzxMod Digital)\n\n` +
                          `2. Konfirmasi pembayaran di:\n   https://tiktok.com/@fanzxmod35\n   atau WhatsApp: 0812-3456-7890`;
            
            alert(message);
            document.getElementById('upgradeModal').classList.add('hidden');
            showToast('Silakan selesaikan pembayaran untuk mengaktifkan upgrade Anda', 'info');
        }

        // ============ LOGOUT ============
        function logoutUser() {
            if (confirm('Yakin ingin logout dari akun ini?')) {
                localStorage.removeItem('darkvoid_current_user');
                SYSTEM.currentUser = null;
                
                document.getElementById('appScreen').style.display = 'none';
                document.getElementById('loginScreen').style.display = 'flex';
                
                // Reset form login
                document.getElementById('loginForm').reset();
                document.getElementById('registerForm').reset();
                clearError('loginError');
                clearSuccess('loginSuccess');
                clearError('registerError');
                clearSuccess('registerSuccess');
                
                // Set tab ke login
                document.querySelector('[data-tab="login"]').click();
                
                // Tutup modal jika terbuka
                document.getElementById('settingsModal').classList.add('hidden');
                document.getElementById('upgradeModal').classList.add('hidden');
                
                // Tutup admin panel jika terbuka
                if (adminPanel) {
                    adminPanel.remove();
                    adminPanel = null;
                }
                
                showToast('Logout berhasil. Sampai jumpa kembali!', 'info');
            }
        }

        // ============ FIX ADMIN PANEL ============
        function showAdminPanel() {
            // Hapus admin panel sebelumnya jika ada
            if (adminPanel) {
                adminPanel.remove();
            }
            
            // Buat admin panel
            adminPanel = document.createElement('div');
            adminPanel.className = 'admin-panel';
            adminPanel.innerHTML = `
                <button class="close-admin" id="closeAdminPanel">
                    <i class="fas fa-times"></i>
                </button>
                <div class="admin-header">
                    <h1 class="admin-title">Admin Panel - DARKVOID</h1>
                    <div class="admin-subtitle">Hanya untuk user fanzxmod</div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalUsers">0</div>
                        <div class="stat-label">Total Users</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="activeToday">0</div>
                        <div class="stat-label">Aktif Hari Ini</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="premiumUsers">0</div>
                        <div class="stat-label">Premium Users</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalChats">0</div>
                        <div class="stat-label">Total Chats</div>
                    </div>
                </div>
                
                <div class="admin-grid">
                    <div class="admin-card">
                        <h3><i class="fas fa-users"></i> Daftar Semua User</h3>
                        <input type="text" class="search-box" id="searchUsers" placeholder="Cari user...">
                        <div class="user-list" id="userList"></div>
                    </div>
                    
                    <div class="admin-card">
                        <h3><i class="fas fa-crown"></i> Upgrade User</h3>
                        <div class="admin-form-group">
                            <label>Username yang ingin diupgrade</label>
                            <div class="manual-user-input">
                                <input type="text" id="manualUsername" class="form-input" placeholder="Ketik username...">
                                <button class="admin-btn upgrade" id="verifyUserBtn">
                                    <i class="fas fa-check"></i> Cek
                                </button>
                            </div>
                            <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                                * Ketik username secara manual
                            </div>
                        </div>
                        
                        <div id="userInfoSection" style="display: none;">
                            <div class="info-row">
                                <div class="info-label">Username:</div>
                                <div class="info-value" id="upgradeUsername">-</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Tier Saat Ini:</div>
                                <div class="info-value" id="upgradeCurrentTier">-</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Status:</div>
                                <div class="info-value" id="upgradeStatus">-</div>
                            </div>
                        </div>
                        
                        <div class="admin-form-group">
                            <label>Pilih Paket Upgrade</label>
                            <select class="select-input" id="upgradePackage">
                                <option value="">Pilih paket...</option>
                                <option value="VIP">VIP - 1 Hari (Rp 2.000)</option>
                                <option value="PREMIUM">PREMIUM - 3 Hari (Rp 5.000)</option>
                                <option value="VVIP">VVIP - 7 Hari (Rp 10.000)</option>
                                <option value="KVIP">KVIP - 30 Hari (Rp 20.000)</option>
                            </select>
                        </div>
                        
                        <div style="margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.2); border-radius: var(--border-radius-sm);">
                            <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 8px;">
                                <i class="fas fa-info-circle"></i> Detail Paket:
                            </div>
                            <div id="packageDetails" style="font-size: 12px; color: var(--text-secondary);">
                                Pilih paket untuk melihat detail
                            </div>
                        </div>
                        
                        <button class="btn" id="processUpgrade" style="margin-top: 20px;">
                            <i class="fas fa-check"></i>
                            Proses Upgrade User
                        </button>
                    </div>
                    
                    <div class="admin-card">
                        <h3><i class="fas fa-tools"></i> Tools Admin</h3>
                        <button class="admin-btn upgrade" style="margin-bottom: 10px; width: 100%;" id="refreshDataBtn">
                            <i class="fas fa-sync"></i> Refresh Data
                        </button>
                        <button class="admin-btn delete" style="width: 100%; margin-bottom: 10px;" id="deleteInactiveBtn">
                            <i class="fas fa-trash"></i> Hapus User Tidak Aktif (30 hari)
                        </button>
                        <button class="admin-btn" style="width: 100%; background: var(--glass-bg); color: var(--text-primary);" id="resetChatCountBtn">
                            <i class="fas fa-redo"></i> Reset Chat Count Semua User
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(adminPanel);
            
            // Load data
            loadAdminData();
            
            // Event listeners
            document.getElementById('closeAdminPanel').addEventListener('click', () => {
                adminPanel.remove();
                adminPanel = null;
                adminMode = false;
            });
            
            document.getElementById('searchUsers').addEventListener('input', (e) => {
                filterUsers(e.target.value);
            });
            
            document.getElementById('verifyUserBtn').addEventListener('click', verifyUserForUpgrade);
            document.getElementById('processUpgrade').addEventListener('click', processAdminUpgrade);
            document.getElementById('refreshDataBtn').addEventListener('click', loadAdminData);
            document.getElementById('deleteInactiveBtn').addEventListener('click', deleteInactiveUsers);
            document.getElementById('resetChatCountBtn').addEventListener('click', resetAllChatCounts);
            
            // Package selection listener
            document.getElementById('upgradePackage').addEventListener('change', updatePackageDetails);
            
            // Enter key untuk manual username input
            document.getElementById('manualUsername').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    verifyUserForUpgrade();
                }
            });
            
            // Tambah mode admin
            adminMode = true;
        }

        function loadAdminData() {
            const users = JSON.parse(localStorage.getItem('darkvoid_users') || '[]');
            
            // Update stats
            document.getElementById('totalUsers').textContent = users.length;
            
            // Hitung user aktif hari ini
            const today = new Date().toDateString();
            let activeToday = 0;
            let premiumUsers = 0;
            let totalChats = 0;
            
            users.forEach(username => {
                const userData = JSON.parse(localStorage.getItem('darkvoid_user_' + username) || '{}');
                
                // Cek aktif hari ini
                if (userData.lastLogin) {
                    const lastLoginDate = new Date(userData.lastLogin).toDateString();
                    if (lastLoginDate === today) {
                        activeToday++;
                    }
                }
                
                // Cek premium user
                if (userData.tier && userData.tier !== 'MEMBER') {
                    premiumUsers++;
                }
                
                // Hitung total chats
                const userChats = JSON.parse(localStorage.getItem('darkvoid_chats_' + username) || '[]');
                totalChats += userChats.length;
            });
            
            document.getElementById('activeToday').textContent = activeToday;
            document.getElementById('premiumUsers').textContent = premiumUsers;
            document.getElementById('totalChats').textContent = totalChats;
            
            // Load user list
            loadUserList();
        }

        function loadUserList() {
            const users = JSON.parse(localStorage.getItem('darkvoid_users') || '[]');
            const userList = document.getElementById('userList');
            const searchTerm = document.getElementById('searchUsers').value.toLowerCase();
            
            userList.innerHTML = '';
            
            if (users.length === 0) {
                userList.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-muted);">Belum ada user terdaftar</div>';
                return;
            }
            
            users.forEach(username => {
                if (searchTerm && !username.toLowerCase().includes(searchTerm)) {
                    return;
                }
                
                const userData = JSON.parse(localStorage.getItem('darkvoid_user_' + username) || '{}');
                const userItem = document.createElement('div');
                userItem.className = 'user-item';
                
                // Format last login
                let lastLoginText = 'Belum pernah login';
                if (userData.lastLogin) {
                    const lastLoginDate = new Date(userData.lastLogin);
                    lastLoginText = lastLoginDate.toLocaleDateString('id-ID');
                }
                
                // Get tier class
                const tierClass = TIERS[userData.tier]?.tierClass || 'tier-member';
                const tierText = userData.tier || 'MEMBER';
                
                userItem.innerHTML = `
                    <div class="user-item-info">
                        <div class="user-item-name">${username}</div>
                        <div class="user-item-tier ${tierClass}">${tierText}</div>
                        <div style="font-size: 11px; color: var(--text-muted); margin-top: 4px;">
                            Login: ${lastLoginText}
                        </div>
                    </div>
                    <div class="user-item-actions">
                        <button class="admin-btn upgrade" onclick="selectUserForUpgrade('${username}')">
                            <i class="fas fa-crown"></i>
                        </button>
                        ${username !== ADMIN_USERNAME ? 
                            `<button class="admin-btn delete" onclick="deleteUserFromList('${username}')">
                                <i class="fas fa-trash"></i>
                            </button>` : 
                            `<button class="admin-btn" style="background: var(--glass-bg); color: var(--text-muted);" disabled>
                                <i class="fas fa-user-shield"></i>
                            </button>`
                        }
                    </div>
                `;
                
                userList.appendChild(userItem);
            });
        }

        function filterUsers(searchTerm) {
            const userItems = document.querySelectorAll('.user-item');
            
            userItems.forEach(item => {
                const userName = item.querySelector('.user-item-name').textContent.toLowerCase();
                if (userName.includes(searchTerm.toLowerCase())) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        function selectUserForUpgrade(username) {
            document.getElementById('manualUsername').value = username;
            verifyUserForUpgrade();
            showToast(`User ${username} dipilih untuk upgrade`, 'info');
        }

        function verifyUserForUpgrade() {
            const username = document.getElementById('manualUsername').value.trim();
            
            if (!username) {
                showToast('Masukkan username terlebih dahulu!', 'warning');
                return;
            }
            
            const userData = JSON.parse(localStorage.getItem('darkvoid_user_' + username));
            
            if (!userData) {
                showToast(`User ${username} tidak ditemukan!`, 'error');
                document.getElementById('userInfoSection').style.display = 'none';
                return;
            }
            
            // Tampilkan info user
            document.getElementById('upgradeUsername').textContent = username;
            document.getElementById('upgradeCurrentTier').textContent = userData.tier || 'MEMBER';
            
            // Cek status expiry
            let status = 'AKTIF';
            if (userData.expiry) {
                const expiryDate = new Date(userData.expiry);
                const now = new Date();
                if (expiryDate < now) {
                    status = 'KEDALUWARSA';
                }
            }
            document.getElementById('upgradeStatus').textContent = status;
            
            document.getElementById('userInfoSection').style.display = 'block';
            showToast(`User ${username} ditemukan!`, 'success');
        }

        function updatePackageDetails() {
            const packageType = document.getElementById('upgradePackage').value;
            const packageDetails = document.getElementById('packageDetails');
            
            if (!packageType) {
                packageDetails.innerHTML = 'Pilih paket untuk melihat detail';
                return;
            }
            
            const tier = TIERS[packageType];
            if (tier) {
                packageDetails.innerHTML = `
                    <strong>${packageType}</strong><br>
                    Masa berlaku: ${tier.days} hari<br>
                    Limit pesan: ${tier.limit === 9999 ? 'Tak terbatas' : tier.limit + '/hari'}<br>
                    Harga: Rp ${tier.price.toLocaleString('id-ID')}
                `;
            }
        }

        // ============ ADMIN UPGRADE USER FUNCTION ============
        function processAdminUpgrade() {
            const username = document.getElementById('manualUsername').value.trim();
            const packageType = document.getElementById('upgradePackage').value;
            
            if (!username) {
                showToast('Masukkan username terlebih dahulu!', 'warning');
                return;
            }
            
            if (!packageType) {
                showToast('Pilih paket upgrade!', 'warning');
                return;
            }
            
            const userData = JSON.parse(localStorage.getItem('darkvoid_user_' + username));
            if (!userData) {
                showToast(`User ${username} tidak ditemukan!`, 'error');
                return;
            }
            
            // Konfirmasi upgrade
            if (!confirm(`Upgrade ${username} ke ${packageType}?`)) {
                return;
            }
            
            // Update tier
            userData.tier = packageType;
            
            // Hitung expiry date
            const days = TIERS[packageType]?.days || 30;
            const expiryDate = new Date();
            expiryDate.setDate(expiryDate.getDate() + days);
            userData.expiry = expiryDate.toISOString();
            
            // Reset chat count untuk user ini
            localStorage.removeItem('darkvoid_chat_count_' + username);
            localStorage.removeItem('darkvoid_last_chat_date_' + username);
            
            // Simpan perubahan
            localStorage.setItem('darkvoid_user_' + username, JSON.stringify(userData));
            
            // Jika user yang diupgrade sedang login, update UI mereka
            if (SYSTEM.currentUser && SYSTEM.currentUser.username === username) {
                // Update current user data
                SYSTEM.currentUser = userData;
                updateUserInfo();
                showToast(`Akun Anda telah diupgrade ke ${packageType}!`, 'success');
            }
            
            // Reset form
            document.getElementById('manualUsername').value = '';
            document.getElementById('upgradePackage').value = '';
            document.getElementById('userInfoSection').style.display = 'none';
            document.getElementById('packageDetails').innerHTML = 'Pilih paket untuk melihat detail';
            
            // Refresh data
            loadAdminData();
            
            showToast(`User ${username} berhasil diupgrade ke ${packageType} (${days} hari)`, 'success');
        }

        function deleteUserFromList(username) {
            if (username === ADMIN_USERNAME) {
                showToast('Tidak dapat menghapus akun admin!', 'error');
                return;
            }
            
            if (confirm(`Hapus user ${username}? Semua data akan dihapus permanen.`)) {
                deleteUserData(username);
                loadAdminData();
                showToast(`User ${username} berhasil dihapus`, 'success');
            }
        }

        function deleteInactiveUsers() {
            if (!confirm('Hapus semua user yang tidak aktif selama 30 hari?')) {
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('darkvoid_users') || '[]');
            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
            
            let deletedCount = 0;
            
            users.forEach(username => {
                if (username === ADMIN_USERNAME) return;
                
                const userData = JSON.parse(localStorage.getItem('darkvoid_user_' + username) || '{}');
                
                if (!userData.lastLogin) {
                    // Jika belum pernah login, hapus
                    deleteUserData(username);
                    deletedCount++;
                } else {
                    const lastLoginDate = new Date(userData.lastLogin);
                    if (lastLoginDate < thirtyDaysAgo) {
                        deleteUserData(username);
                        deletedCount++;
                    }
                }
            });
            
            showToast(`Berhasil menghapus ${deletedCount} user tidak aktif`, 'success');
            loadAdminData();
        }

        function resetAllChatCounts() {
            if (!confirm('Reset chat count semua user? Ini akan reset limit harian semua user.')) {
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('darkvoid_users') || '[]');
            let resetCount = 0;
            
            users.forEach(username => {
                localStorage.removeItem('darkvoid_chat_count_' + username);
                localStorage.removeItem('darkvoid_last_chat_date_' + username);
                resetCount++;
            });
            
            showToast(`Berhasil reset chat count ${resetCount} user`, 'success');
        }

        function deleteUserData(username) {
            localStorage.removeItem('darkvoid_user_' + username);
            localStorage.removeItem('darkvoid_chats_' + username);
            localStorage.removeItem('darkvoid_chat_count_' + username);
            localStorage.removeItem('darkvoid_last_chat_date_' + username);
            
            const users = JSON.parse(localStorage.getItem('darkvoid_users') || '[]');
            const updatedUsers = users.filter(u => u !== username);
            localStorage.setItem('darkvoid_users', JSON.stringify(updatedUsers));
            
            // Jika user sedang login, logout
            if (SYSTEM.currentUser && SYSTEM.currentUser.username === username) {
                logoutUser();
            }
        }

        // ============ HELPER FUNCTIONS ============
        function showToast(message, type = 'info') {
            const toastContainer = document.getElementById('toastContainer');
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icons = {
                success: 'fa-check-circle',
                error: 'fa-exclamation-circle',
                warning: 'fa-exclamation-triangle',
                info: 'fa-info-circle'
            };
            
            toast.innerHTML = `
                <div class="toast-icon">
                    <i class="fas ${icons[type] || icons.info}"></i>
                </div>
                <div class="toast-content">${message}</div>
                <button class="toast-close">&times;</button>
            `;
            
            toast.querySelector('.toast-close').addEventListener('click', () => {
                dismissToast(toast);
            });
            
            toastContainer.appendChild(toast);
            
            // Auto dismiss after 5 seconds
            setTimeout(() => {
                dismissToast(toast);
            }, 5000);
        }

        function dismissToast(toast) {
            toast.style.animation = 'fadeOut 0.3s ease-out forwards';
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            }, 300);
        }

        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.style.display = 'block';
        }

        function showSuccess(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.style.display = 'block';
        }

        function clearError(elementId) {
            const element = document.getElementById(elementId);
            element.textContent = '';
            element.style.display = 'none';
        }

        function clearSuccess(elementId) {
            const element = document.getElementById(elementId);
            element.textContent = '';
            element.style.display = 'none';
        }

        // Auto-resize textarea
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 200) + 'px';
        }

        function closeMobileSidebar() {
            document.getElementById('sidebar').classList.remove('active');
            document.getElementById('sidebarOverlay').classList.remove('active');
        }
    </script>
</body>
</html>